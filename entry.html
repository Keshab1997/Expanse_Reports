<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Entry | ExpensePro</title>
    
    <!-- ফন্ট এবং আইকন -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS লিঙ্ক -->
    <link rel="stylesheet" href="assets/css/style.css"> <!-- মেইন লেআউট -->
    <link rel="stylesheet" href="assets/css/entry.css"> <!-- ফর্ম ডিজাইন -->
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>

<div class="dashboard-wrapper">
    
    <!-- সাইডবার -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-brand">
            <i class="fa-solid fa-wallet"></i> 
            <span>ExpensePro</span>
            <button class="close-btn" id="closeSidebar"><i class="fa-solid fa-xmark"></i></button>
        </div>

        <ul class="sidebar-menu">
            <li><a href="index.html"><i class="fa-solid fa-house"></i> <span>Dashboard</span></a></li>
            <li><a href="entry.html" class="active"><i class="fa-solid fa-pen"></i> <span>Add Entry</span></a></li>
            <li><a href="list.html"><i class="fa-solid fa-chart-pie"></i> <span>Reports</span></a></li>
            <li><a href="profile.html"><i class="fa-solid fa-user"></i> <span>Profile</span></a></li>
        </ul>

        <div class="sidebar-footer">
            <a href="#" onclick="logout()" class="logout-btn">
                <i class="fa-solid fa-right-from-bracket"></i> <span>Logout</span>
            </a>
        </div>
    </aside>

    <!-- মেইন কন্টেন্ট -->
    <div class="main-content">
        
        <!-- হেডার -->
        <header class="topbar">
            <div class="header-left">
                <h2 class="page-title">Add Entry</h2>
            </div>
            <div class="header-right" style="display: flex; align-items: center; gap: 15px;">
                <div class="top-profile">
                    <img src="https://via.placeholder.com/40" id="headerAvatar" class="header-avatar" alt="User">
                </div>
                <button id="menuToggle" class="hamburger-btn">
                    <i class="fa-solid fa-bars"></i>
                </button>
            </div>
        </header>

        <!-- ফর্ম বডি -->
        <div class="content-body">
            
            <!-- কার্ড শুরু -->
            <div class="entry-card">
                
                <div class="card-header">
                    <h2>✍️ New Expense</h2>
                    <p>Track your daily spending easily</p>
                </div>

                <form id="expenseForm">
    <!-- ১. তারিখ -->
    <div class="form-group">
        <label>Date</label>
        <input type="date" id="date" required>
    </div>

    <!-- ২. ক্যাটাগরি -->
    <div class="form-group">
        <label>Category</label>
        <div class="input-with-btn">
            <select id="category" required>
                <option value="" disabled selected>Select...</option>
            </select>
            <button type="button" class="btn-icon" onclick="openModal()" title="New Category">
                <i class="fa-solid fa-plus"></i>
            </button>
        </div>
    </div>

    <!-- ৩. নাম (Full Width) -->
    <div class="form-group full-width">
        <label>Payee / Shop Name</label>
        <input type="text" id="payee" placeholder="Ex: Starbucks, Grocery Store" required autocomplete="off">
    </div>

    <!-- ৪. বর্ণনা (Full Width) -->
    <div class="form-group full-width">
        <label>Description (Optional)</label>
        <input type="text" id="purpose" placeholder="Ex: Coffee with friends" autocomplete="off">
    </div>

    <!-- ৫. টাকা (Full Width) -->
    <div class="form-group full-width">
        <label>Amount (₹)</label>
        <input type="number" id="amount" placeholder="0.00" step="0.01" min="1" required 
               style="font-size: 1.2rem; font-weight: bold; color: #4f46e5;">
    </div>

    <!-- ৬. সেভ বাটন -->
    <div class="form-actions">
        <button type="submit" class="btn-primary">
            <span id="btnText">Save Transaction</span>
        </button>
    </div>
    
    <!-- ৭. এক্সেল আপলোড -->
    <div class="upload-box">
        <input type="file" id="excelInput" accept=".xlsx, .xls" style="display: none;" onchange="handleFileUpload(this)">
        <button type="button" class="btn-upload" onclick="document.getElementById('excelInput').click()">
            <i class="fa-solid fa-file-excel"></i> Upload Bulk from Excel
        </button>
        <small style="display:block; text-align:center; color:#9ca3af; margin-top: 5px; font-size: 0.8rem;">Supports .xlsx files</small>
    </div>
</form>
            </div>
            <!-- কার্ড শেষ -->

        </div>
    </div>
</div>

<!-- মোডাল -->
<div id="catModal" class="modal-overlay">
    <div class="modal-box">
        <h3>Add New Category</h3>
        <p style="color:#666; margin-bottom:15px; font-size:0.9rem;">Create a category to organize expenses.</p>
        <input type="text" id="newCatName" placeholder="Category Name (e.g. Travel)">
        
        <div class="modal-actions">
            <button class="btn-text" onclick="closeModal()">Cancel</button>
            <button class="btn-primary small" onclick="saveCategory()">Create</button>
        </div>
    </div>
</div>

<!-- টোস্ট -->
<div id="toast" class="toast">
    <i class="fa-solid fa-circle-check"></i> Saved Successfully!
</div>

<!-- স্ক্রিপ্ট -->
<script src="assets/js/config.js"></script>
<script src="assets/js/auth.js"></script>
<script src="assets/js/entry.js"></script>
<script src="assets/js/sidebar.js"></script>

<script>
    // মোডাল হ্যান্ডলিং
    const modal = document.getElementById('catModal');
    function openModal() { modal.style.display = 'flex'; }
    function closeModal() { modal.style.display = 'none'; }
    
    // বাইরে ক্লিক করলে মোডাল বন্ধ
    modal.addEventListener('click', (e) => {
        if(e.target === modal) closeModal();
    });
</script>

</body>
</html>